<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        let stock = {
            'fruits':[
                'strawberry','grapes','banana','apple'
            ],
            'liquid':[
                'water','ice'
            ],
            'holder':[
                'cone','cup','stick'
            ],
            'toppings':[
                'chocolate','sprinkles'
            ]
        }

        let is_shop_open = true;
        
        let order = (time,work)=>{
            return new Promise((resolve,reject)=>{
                if(is_shop_open){
                    setTimeout(()=>{
                        resolve( work() );
                    },time)
                    
                }else{
                    reject(console.log('our shop is closed'));
                }
            })
        }

        order(2000,()=>console.log(`${stock.fruits[0]} was selected`))
        .then(()=>{
            return order(0000, ()=>console.log('production has started'))
        })
        .then(()=>{
            return order(2000, ()=>console.log('the fruit was chopped'))
        })
        .then(()=>{
            return order(1000,()=>console.log('the machine was started'))
        })
        .then(()=>{
            return order(2000,()=>console.log(`${stock.holder[2]} was selected`))
        })
        .then(()=>{
            return order(3000,()=>console.log(`${stock.toppings[1]} was selected`))
        }).then(()=>{
            return order(2000,()=>console.log('ice cream was served'))
        }).catch(()=>{
            console.log('customer left');
        }).finally(()=>{
            console.log('done');
        })
    </script>
</body>
</html>